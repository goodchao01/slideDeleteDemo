<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Slide</title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		.fl {
			float: left;
		}

		.container {
			width: 100%;
			height: auto;
			min-height: 600px;
			background: #ccc;
			position: relative;
			overflow: hidden;
		}

		.list-view {
			overflow: hidden;
			list-style: none;
			width: 100%;
			position: relative;
		}

		.list-view li {
			transition: all 0.35s;
			height: 60px;
			width: 100%;
			background: rgb(167, 218, 194);
			border-bottom: 1px solid rgb(179, 175, 175);
			overflow: hidden;
		}

		.list-img {
			width: 50px;
			height: 50px;
			background: #5ddada;
			margin: 5px 10px;
		}
		.list-content {
			line-height: 60px;
		}

		.swipe-box {
			transition: all 0.35s;
			position: relative;
			left: 0;
		}
		.swipe-box.hide {
			left: 100% !important;
		}
		.swipe-box.hide.up .del-btn, .swipe-box.hide.up li {
			height: 0px;
			border: none;
		}

		.swipe-bar {
			background:#6c8888;
		}
		.del-btn {
			transition: all 0.35s;
			width: 70px;
			height: 60px;
			background: rgb(202, 60, 60);
			color: #fff;
			text-align: center;
			line-height: 60px;
			position: absolute;
			top: 0;
			right: -70px;
		}
	</style>

</head>

<body>
	<div class="container">
		<ul class="list-view">
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表1</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表2</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表3</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表4</div>

					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表5</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表6</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表7</div>


					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表8</div>

					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表9</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表10</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表11</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表12</div>

					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表13</div>

					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表14</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>


						<div class="list-content fl">列表11</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表12</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表13</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>
						<div class="list-content fl">列表14</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
			<div class="swipe-box">
				<div class="swipe-bar">
					<li>
						<div class="list-img fl"></div>

						<div class="list-content fl">列表15</div>
					</li>
				</div>
				<span class="del-btn">删除</span>
			</div>
		</ul>
	</div>

	<script>
		var swipeBars = document.querySelectorAll(".swipe-bar"); 
		var topValue = 0,// 上次滚动条到顶部的距离
		    interval = null,
		    isScroll = false;

		document.body.onclick = function() {
			for(var i=0; i<swipeBars.length; i++) {
				swipeBars[i].parentNode.style.left = '0px';
			}
		};

		for(var i=0; i<swipeBars.length; i++) {
			var touchStart = 0,
				beginX = 0,
				// nodeBeginY = 0,
				slideRange = 0,
				isExpanded = false,
				direction = 0;
	
			//手指接触屏幕
			swipeBars[i].addEventListener("touchstart", function(e) {
				// var e = e || event;
				// e.preventDefault();

				startx = e.touches[0].pageX;
				starty = e.touches[0].pageY;

				beginX = e.targetTouches[0].pageX;

				isScroll = false;

				for(var i=0; i<swipeBars.length; i++) {
					swipeBars[i].parentNode.style.left = '0px';
				}
			}, false);
			
			//滑动屏幕
			swipeBars[i].addEventListener("touchmove", function(e) {
				var e = e || event;
			  	setTimeout(function() {
			  		if(document.body.scrollTop != topValue) {
			  			isScroll = true;
			  			e.preventDefault();
			  		}
			  	}, 30);

			  	topValue = document.body.scrollTop;

				var endx, endy;
				endx = e.changedTouches[0].pageX;
				endy = e.changedTouches[0].pageY;
				direction = getDirection(startx, starty, endx, endy);				
				
				if((direction == 3 || direction == 4) && !isScroll) {

					e.preventDefault();

					var touchX = e.targetTouches[0].pageX;
						slideRange = touchX - beginX;

					// 更改位置
					this.parentNode.style.left = slideRange + 'px';
					//限定两侧位置
					if (slideRange < -70) {
						this.parentNode.style.left = '-70px';
					} else if (slideRange > 0) {
						this.parentNode.style.left = '0px';
					}
				}
			}, false);

			//离开屏幕
			swipeBars[i].addEventListener("touchend", function(e) {
				var e = e || event;
				e.preventDefault();
				console.log(isScroll);
				if (slideRange > -35) {
					this.parentNode.style.left = '0';
					if(!isExpanded && direction === 0 && !isScroll) {
						var alertText = this.innerText;
						alert('您点击了' + alertText);
					}
					isExpanded = false;
				} else {
					this.parentNode.style.left = '-70px';
					isExpanded = true;
				}
				isScroll = false;
				direction = 0;
				slideRange = 0;
			}, false);

			// 点击删除按钮
			swipeBars[i].parentNode.querySelector('.del-btn').onclick = function(e) {
				e.preventDefault();
				this.parentNode.className += ' hide';
				setTimeout(function() {
					this.parentNode.className += ' up';
					isExpanded = false;
				}.bind(this), 350);
			};
		}

		var startx, starty;
        //获得角度
        function getAngle(angx, angy) {
            return Math.atan2(angy, angx) * 180 / Math.PI;
        }
        //根据起点终点返回方向 1向上 2向下 3向左 4向右 0未滑动
        function getDirection(startx, starty, endx, endy) {
            var angx = endx - startx;
            var angy = endy - starty;
            var result = 0;
    
            //如果滑动距离太短
            if (Math.abs(angx) < 5 && Math.abs(angy) < 5) {
                return result;
            }
    
            var angle = getAngle(angx, angy);
            if (angle >= -150 && angle <= -30) {
                result = 1;
            } else if (angle > 30 && angle < 150) {
                result = 2;
            } else if ((angle >= 150 && angle <= 180) || (angle >= -180 && angle < -135)) {
                result = 3;
            } else if (angle >= -30 && angle <= 30) {
                result = 4;
            }
    
            return result;
		}

	</script>
</body>

</html>
